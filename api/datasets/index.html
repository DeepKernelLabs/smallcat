
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A small, modular data catalog.">
      
      
      
      
        <link rel="prev" href="../catalog/">
      
      
      
        
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Datasets - Smallcat</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#datasets" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Smallcat" class="md-header__button md-logo" aria-label="Smallcat" data-md-component="logo">
      
  <img src="../../assets/images/smallcat-logo-square.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Smallcat
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Datasets
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2c3.87 0 7 3.13 7 7 0 2.38-1.19 4.47-3 5.74V17c0 .55-.45 1-1 1H6c-.55 0-1-.45-1-1v-2.26C3.19 13.47 2 11.38 2 9c0-3.87 3.13-7 7-7M6 21v-1h6v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1M9 4C6.24 4 4 6.24 4 9c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58 0-2.76-2.24-5-5-5m10 9h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9zm-2.15 5.65L18 15l1.15 3.65z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="amber"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/DeepKernelLabs/smallcat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    DeepKernelLabs/smallcat
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Get Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/standalone/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../catalog/" class="md-tabs__link">
          
  
  
  API reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Smallcat" class="md-nav__button md-logo" aria-label="Smallcat" data-md-component="logo">
      
  <img src="../../assets/images/smallcat-logo-square.png" alt="logo">

    </a>
    Smallcat
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/DeepKernelLabs/smallcat" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    DeepKernelLabs/smallcat
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Get Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Get Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/standalone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Standalone
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/airflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Airflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../catalog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Catalog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Datasets
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Datasets
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#smallcat.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        datasets
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csv" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSV
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.load_arrow_record_batch_reader" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_arrow_record_batch_reader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_arrow_table
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="save_arrow_table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table--raises" class="md-nav__link">
    <span class="md-ellipsis">
      
        Raises:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.from_conn_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_conn_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.load_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.save_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pandas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVLoadOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVLoadOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.sep" class="md-nav__link">
    <span class="md-ellipsis">
      
        sep
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        sample_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.all_varchar" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_varchar
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVSaveOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVSaveOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.sep" class="md-nav__link">
    <span class="md-ellipsis">
      
        sep
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.overwrite" class="md-nav__link">
    <span class="md-ellipsis">
      
        overwrite
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Excel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Excel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExcelDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.load_arrow_record_batch_reader" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_arrow_record_batch_reader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.save_arrow_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_arrow_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.from_conn_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_conn_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.load_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.save_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pandas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelLoadOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExcelLoadOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.range" class="md-nav__link">
    <span class="md-ellipsis">
      
        range
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.all_varchar" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_varchar
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.empty_as_varchar" class="md-nav__link">
    <span class="md-ellipsis">
      
        empty_as_varchar
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelSaveOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExcelSaveOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions.sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        sheet
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parquet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parquet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parquet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParquetDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParquetDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.load_arrow_record_batch_reader" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_arrow_record_batch_reader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.save_arrow_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_arrow_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.from_conn_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_conn_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.load_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.save_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pandas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParquetLoadOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParquetLoadOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.binary_as_string" class="md-nav__link">
    <span class="md-ellipsis">
      
        binary_as_string
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.file_row_number" class="md-nav__link">
    <span class="md-ellipsis">
      
        file_row_number
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.hive_partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      
        hive_partitioning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.union_by_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        union_by_name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParquetSaveOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParquetSaveOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.overwrite" class="md-nav__link">
    <span class="md-ellipsis">
      
        overwrite
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.partition_by" class="md-nav__link">
    <span class="md-ellipsis">
      
        partition_by
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.write_partition_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_partition_columns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delta-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delta Table
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Delta Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        DeltaTableDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DeltaTableDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset._delta_storage_options" class="md-nav__link">
    <span class="md-ellipsis">
      
        _delta_storage_options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset._set_databricks_acces_variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        _set_databricks_acces_variables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.load_arrow_record_batch_reader" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_arrow_record_batch_reader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.save_arrow_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_arrow_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.from_conn_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_conn_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.load_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.save_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pandas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        DeltaTableLoadOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DeltaTableLoadOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.version" class="md-nav__link">
    <span class="md-ellipsis">
      
        version
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.without_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        without_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.log_buffer_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        log_buffer_size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        DeltaTableSaveOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DeltaTableSaveOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.partition_by" class="md-nav__link">
    <span class="md-ellipsis">
      
        partition_by
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.schema_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        schema_mode
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#smallcat.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        datasets
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csv" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSV
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset--notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notes:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.load_arrow_record_batch_reader" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_arrow_record_batch_reader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_arrow_table
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="save_arrow_table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table--raises" class="md-nav__link">
    <span class="md-ellipsis">
      
        Raises:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.from_conn_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_conn_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.load_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVDataset.save_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pandas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVLoadOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVLoadOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.sep" class="md-nav__link">
    <span class="md-ellipsis">
      
        sep
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        sample_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.all_varchar" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_varchar
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVSaveOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVSaveOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.sep" class="md-nav__link">
    <span class="md-ellipsis">
      
        sep
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.overwrite" class="md-nav__link">
    <span class="md-ellipsis">
      
        overwrite
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Excel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Excel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExcelDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.load_arrow_record_batch_reader" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_arrow_record_batch_reader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.save_arrow_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_arrow_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.from_conn_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_conn_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.load_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelDataset.save_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pandas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelLoadOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExcelLoadOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        sheet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.range" class="md-nav__link">
    <span class="md-ellipsis">
      
        range
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.all_varchar" class="md-nav__link">
    <span class="md-ellipsis">
      
        all_varchar
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.empty_as_varchar" class="md-nav__link">
    <span class="md-ellipsis">
      
        empty_as_varchar
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExcelSaveOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExcelSaveOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions.header" class="md-nav__link">
    <span class="md-ellipsis">
      
        header
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions.sheet" class="md-nav__link">
    <span class="md-ellipsis">
      
        sheet
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parquet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parquet
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parquet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParquetDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParquetDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.load_arrow_record_batch_reader" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_arrow_record_batch_reader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.save_arrow_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_arrow_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.from_conn_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_conn_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.load_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetDataset.save_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pandas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParquetLoadOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParquetLoadOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.binary_as_string" class="md-nav__link">
    <span class="md-ellipsis">
      
        binary_as_string
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.file_row_number" class="md-nav__link">
    <span class="md-ellipsis">
      
        file_row_number
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.hive_partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      
        hive_partitioning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.union_by_name" class="md-nav__link">
    <span class="md-ellipsis">
      
        union_by_name
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParquetSaveOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParquetSaveOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.overwrite" class="md-nav__link">
    <span class="md-ellipsis">
      
        overwrite
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.partition_by" class="md-nav__link">
    <span class="md-ellipsis">
      
        partition_by
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.write_partition_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_partition_columns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delta-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delta Table
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Delta Table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        DeltaTableDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DeltaTableDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset._delta_storage_options" class="md-nav__link">
    <span class="md-ellipsis">
      
        _delta_storage_options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset._set_databricks_acces_variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        _set_databricks_acces_variables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.load_arrow_record_batch_reader" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_arrow_record_batch_reader
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.save_arrow_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_arrow_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.from_conn_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_conn_id
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.load_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_pandas
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.save_pandas" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_pandas
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Options
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        DeltaTableLoadOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DeltaTableLoadOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.version" class="md-nav__link">
    <span class="md-ellipsis">
      
        version
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.without_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        without_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.log_buffer_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        log_buffer_size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        DeltaTableSaveOptions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DeltaTableSaveOptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.partition_by" class="md-nav__link">
    <span class="md-ellipsis">
      
        partition_by
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.schema_mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        schema_mode
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                




              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="datasets">Datasets<a class="headerlink" href="#datasets" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="smallcat.datasets"></a>
    <div class="doc doc-contents first">

        <p>Dataset constructors for common table/file formats.</p>
<p>Re-exports the most common dataset classes so callers can import from
<code>smallcat.datasets</code> directly.</p>


<details class="available-datasets" open>
  <summary>Available datasets</summary>
  <ul>
<li>:class:<code>ParquetDataset</code></li>
<li>:class:<code>CSVDataset</code></li>
<li>:class:<code>ExcelDataset</code></li>
<li>:class:<code>DeltaTableDataset</code></li>
<li>:class:<code>BaseDataset</code> (abstract)</li>
</ul>
</details>









<div class="doc doc-children">












  </div>

    </div>

</div><h2 id="csv">CSV<a class="headerlink" href="#csv" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>CSV dataset using DuckDB's CSV reader/writer.</p>
<p>This module defines :class:<code>CSVDataset</code>, a concrete dataset for CSV/TSV/DSV
files using DuckDB (<code>read_csv_auto</code> / <code>COPY ... WITH (FORMAT CSV)</code>).
All paths are treated as <strong>relative</strong> to the dataset's base URI.</p>


<details class="features" open>
  <summary>Features</summary>
  <ul>
<li>Auto-schema inference (delimiter, header, types) with overrides.</li>
<li>Large-file handling via DuckDB streaming.</li>
<li>Optional Hive-style partitioning on write.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ds = CSVDataset.from_conn_id("local_fs")
tbl = ds.load_arrow_table("bronze/raw/users.csv")
ds.save_arrow_table("silver/users/", tbl)</p>
</blockquote>
</blockquote>
</blockquote>
</details>        <p>Typical options (suggested):
  * Load: <code>header</code>, <code>delimiter</code>, <code>columns</code>, <code>nullstr</code>, <code>types</code>.
  * Save: <code>header</code>, <code>delimiter</code>, <code>partition_by</code>, <code>overwrite</code>.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>An implementation typically builds SQL like:
<code>SELECT * FROM read_csv_auto(? , ...options...)</code> for reading and
<code>COPY (SELECT * FROM tmp_input) TO ? WITH (FORMAT CSV, ...)</code> for writing.</p>
</details>









<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="smallcat.datasets.csv_dataset.CSVDataset" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.csv_dataset.CSVDataset</span>


<a href="#smallcat.datasets.csv_dataset.CSVDataset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span>[<a class="autorefs autorefs-internal" href="#smallcat.datasets.csv_dataset.CSVLoadOptions">CSVLoadOptions</a>, <a class="autorefs autorefs-internal" href="#smallcat.datasets.csv_dataset.CSVSaveOptions">CSVSaveOptions</a>]</code></p>



        <p>Dataset that reads/writes CSV using DuckDB.</p>
<ul>
<li><strong>Paths</strong> are resolved relative to the dataset's connection base
  (local filesystem, <code>gs://</code>, etc.).</li>
<li><strong>Reading</strong> uses <code>DuckDBPyConnection.read_csv</code> under the hood and returns a
  <code>pyarrow.Table</code>.</li>
<li><strong>Writing</strong> uses <code>Relation.write_csv</code> to materialize a table to CSV.</li>
</ul>
<h5 id="smallcat.datasets.csv_dataset.CSVDataset--notes">Notes:<a class="headerlink" href="#smallcat.datasets.csv_dataset.CSVDataset--notes" title="Permanent link">&para;</a></h5>
<ul>
<li>Use :class:<code>CSVLoadOptions</code> to override auto-detection (separator, header,
  per-column types).</li>
<li>Use :class:<code>CSVSaveOptions</code> to control delimiter, header, and overwrite behavior.</li>
</ul>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/csv_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="k">class</span><span class="w"> </span><span class="nc">CSVDataset</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">[</span><span class="n">CSVLoadOptions</span><span class="p">,</span> <span class="n">CSVSaveOptions</span><span class="p">]):</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dataset that reads/writes CSV using DuckDB.</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    - **Paths** are resolved relative to the dataset&#39;s connection base</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">      (local filesystem, `gs://`, etc.).</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    - **Reading** uses `DuckDBPyConnection.read_csv` under the hood and returns a</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">      `pyarrow.Table`.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    - **Writing** uses `Relation.write_csv` to materialize a table to CSV.</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    -----</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    - Use :class:`CSVLoadOptions` to override auto-detection (separator, header,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">      per-column types).</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    - Use :class:`CSVSaveOptions` to control delimiter, header, and overwrite behavior.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stream CSV rows as `RecordBatch`es with an optional filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="n">rel</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">full_uri</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">load_options_dict</span><span class="p">())</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="k">return</span> <span class="n">rel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_record_batch</span><span class="p">()</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a PyArrow Table to CSV.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        path</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            Destination path (file or pattern) relative to the connection base.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            Compression is inferred from the extension (e.g. &#39;.gz&#39;, &#39;.zst&#39;).</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        table</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            The Arrow table to write.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        ------</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        duckdb.IOException</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            If the destination is not writable.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">con</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;tmp_input&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM tmp_input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                <span class="n">full_uri</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.csv_dataset.CSVDataset.load_arrow_record_batch_reader" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_arrow_record_batch_reader</span>


<a href="#smallcat.datasets.csv_dataset.CSVDataset.load_arrow_record_batch_reader" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pyarrow">pa</span></span><span class="o">.</span><span class="n"><span title="pyarrow.RecordBatchReader">RecordBatchReader</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Stream CSV rows as <code>RecordBatch</code>es with an optional filter.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/csv_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream CSV rows as `RecordBatch`es with an optional filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">rel</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">full_uri</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">load_options_dict</span><span class="p">())</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">return</span> <span class="n">rel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_record_batch</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_arrow_table</span>


<a href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_arrow_table</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n"><span title="pyarrow">pa</span></span><span class="o">.</span><span class="n"><span title="pyarrow.Table">Table</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Write a PyArrow Table to CSV.</p>
<h6 id="smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table--parameters">Parameters<a class="headerlink" href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table--parameters" title="Permanent link">&para;</a></h6>
<p>path
    Destination path (file or pattern) relative to the connection base.
    Compression is inferred from the extension (e.g. '.gz', '.zst').
table
    The Arrow table to write.</p>
<h6 id="smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table--raises">Raises:<a class="headerlink" href="#smallcat.datasets.csv_dataset.CSVDataset.save_arrow_table--raises" title="Permanent link">&para;</a></h6>
<p>duckdb.IOException
    If the destination is not writable.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/csv_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a PyArrow Table to CSV.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    path</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        Destination path (file or pattern) relative to the connection base.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Compression is inferred from the extension (e.g. &#39;.gz&#39;, &#39;.zst&#39;).</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    table</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        The Arrow table to write.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    ------</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    duckdb.IOException</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        If the destination is not writable.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">con</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;tmp_input&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM tmp_input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="n">full_uri</span><span class="p">,</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.csv_dataset.CSVDataset.from_conn_id" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_conn_id</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVDataset.from_conn_id" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_conn_id</span><span class="p">(</span><span class="n">conn_id</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">load_options</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.base_dataset.L">L</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save_options</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.base_dataset.S">S</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span></span><span class="p">[</span><span class="n"><span title="smallcat.datasets.base_dataset.L">L</span></span><span class="p">,</span> <span class="n"><span title="smallcat.datasets.base_dataset.S">S</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct an instance by looking up an Airflow connection ID.</p>
<p>Uses <code>airflow.hooks.base.BaseHook</code> (or the SDK alternative) to fetch
the connection and then calls the class constructor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn_id</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Airflow connection ID to resolve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_options</code>
            </td>
            <td>
                  <code><span title="smallcat.datasets.base_dataset.L">L</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional load options model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_options</code>
            </td>
            <td>
                  <code><span title="smallcat.datasets.base_dataset.S">S</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional save options model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span>[<span title="smallcat.datasets.base_dataset.L">L</span>, <span title="smallcat.datasets.base_dataset.S">S</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A fully constructed <code>BaseDataset</code> subclass instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_conn_id</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;BaseDataset[L, S]&quot;</span><span class="p">],</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">conn_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">load_options</span><span class="p">:</span> <span class="n">L</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">save_options</span><span class="p">:</span> <span class="n">S</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BaseDataset[L, S]&quot;</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct an instance by looking up an Airflow connection ID.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Uses `airflow.hooks.base.BaseHook` (or the SDK alternative) to fetch</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    the connection and then calls the class constructor.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">      conn_id: Airflow connection ID to resolve.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">      load_options: Optional load options model.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">      save_options: Optional save options model.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">      A fully constructed `BaseDataset` subclass instance.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="n">BaseHook</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Airflow not available. Install smallcat[airflow]&quot;</span><span class="p">)</span>  <span class="c1"># noqa: TRY003, EM101</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">BaseHook</span><span class="o">.</span><span class="n">get_connection</span><span class="p">(</span><span class="n">conn_id</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">conn</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span> <span class="n">load_options</span><span class="o">=</span><span class="n">load_options</span><span class="p">,</span> <span class="n">save_options</span><span class="o">=</span><span class="n">save_options</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.csv_dataset.CSVDataset.load_pandas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_pandas</span>


<a href="#smallcat.datasets.csv_dataset.CSVDataset.load_pandas" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_pandas</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas">pd</span></span><span class="o">.</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load data as a pandas DataFrame.</p>
<p>This is a convenience wrapper over <code>load_arrow_table</code> and pushes down
filters when provided.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative dataset path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>where</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional SQL filter predicate injected into the query.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of columns to project.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pandas <code>DataFrame</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_pandas</span><span class="p">(</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load data as a pandas DataFrame.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    This is a convenience wrapper over `load_arrow_table` and pushes down</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    filters when provided.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">      path: Relative dataset path.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">      where: Optional SQL filter predicate injected into the query.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">      columns: Optional list of columns to project.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">      A pandas `DataFrame`.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">arrow_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_arrow_table</span><span class="p">(</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">return</span> <span class="n">arrow_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.csv_dataset.CSVDataset.save_pandas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_pandas</span>


<a href="#smallcat.datasets.csv_dataset.CSVDataset.save_pandas" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_pandas</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n"><span title="pandas">pd</span></span><span class="o">.</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Persist a pandas DataFrame.</p>
<p>Converts the DataFrame to a <code>pyarrow.Table</code> and delegates to
<code>save_arrow_table</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative dataset path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame to persist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Persist a pandas DataFrame.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Converts the DataFrame to a `pyarrow.Table` and delegates to</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    `save_arrow_table`.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        path: Relative dataset path.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        df: DataFrame to persist.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        None</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">arrow_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">save_arrow_table</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">arrow_table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="options">Options<a class="headerlink" href="#options" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="smallcat.datasets.csv_dataset.CSVLoadOptions" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.csv_dataset.CSVLoadOptions</span>


<a href="#smallcat.datasets.csv_dataset.CSVLoadOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Options that control how CSV files are <em>read</em>.</p>
<p>These mirror DuckDB's <code>read_csv_auto</code> parameters we expose.
All fields are optional; unset values defer to DuckDB defaults.</p>
<h6 id="smallcat.datasets.csv_dataset.CSVLoadOptions--attributes">Attributes:<a class="headerlink" href="#smallcat.datasets.csv_dataset.CSVLoadOptions--attributes" title="Permanent link">&para;</a></h6>
<p>columns
    Optional mapping of column names to logical types
    (e.g. {"id": "INTEGER", "amount": "DOUBLE"}) used to override
    DuckDB's type inference when auto-detect is not good enough.
sep
    Field separator (e.g. ",", "|", "\t"). If None, DuckDB will try to detect it.
header
    Whether the first row contains column names. If None, DuckDB will detect.
sample_size
    Number of rows to sample for schema detection. If None, DuckDB default applies.
all_varchar
    If True, read all columns as VARCHAR (string). Useful when types are messy.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/csv_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="k">class</span><span class="w"> </span><span class="nc">CSVLoadOptions</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Options that control how CSV files are *read*.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    These mirror DuckDB&#39;s `read_csv_auto` parameters we expose.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    All fields are optional; unset values defer to DuckDB defaults.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    columns</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        Optional mapping of column names to logical types</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        (e.g. {&quot;id&quot;: &quot;INTEGER&quot;, &quot;amount&quot;: &quot;DOUBLE&quot;}) used to override</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        DuckDB&#39;s type inference when auto-detect is not good enough.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    sep</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        Field separator (e.g. &quot;,&quot;, &quot;|&quot;, &quot;\t&quot;). If None, DuckDB will try to detect it.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    header</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        Whether the first row contains column names. If None, DuckDB will detect.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    sample_size</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        Number of rows to sample for schema detection. If None, DuckDB default applies.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    all_varchar</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        If True, read all columns as VARCHAR (string). Useful when types are messy.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">columns</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Override inferred types per column, e.g. {&#39;id&#39;: &#39;INTEGER&#39;}.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Field separator (e.g. &#39;,&#39;, &#39;|&#39;, &#39;</span><span class="se">\\</span><span class="s2">t&#39;); auto-detected if None.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether the first row is a header; auto-detected if None.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Rows to sample for inference; DuckDB default if None.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">all_varchar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;If True, read all columns as VARCHAR.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.csv_dataset.CSVLoadOptions.columns" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">columns</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.columns" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="collections.abc.Mapping" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping">Mapping</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Override inferred types per column, e.g. {&#39;id&#39;: &#39;INTEGER&#39;}.&quot;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.csv_dataset.CSVLoadOptions.sep" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">sep</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.sep" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sep</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Field separator (e.g. &#39;,&#39;, &#39;|&#39;, &#39;</span><span class="se">\\</span><span class="s2">t&#39;); auto-detected if None.&quot;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.csv_dataset.CSVLoadOptions.header" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">header</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.header" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">header</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;Whether the first row is a header; auto-detected if None.&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.csv_dataset.CSVLoadOptions.sample_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">sample_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.sample_size" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sample_size</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;Rows to sample for inference; DuckDB default if None.&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.csv_dataset.CSVLoadOptions.all_varchar" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">all_varchar</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVLoadOptions.all_varchar" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">all_varchar</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;If True, read all columns as VARCHAR.&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="smallcat.datasets.csv_dataset.CSVSaveOptions" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.csv_dataset.CSVSaveOptions</span>


<a href="#smallcat.datasets.csv_dataset.CSVSaveOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Options that control how CSV files are <em>written</em>.</p>
<h6 id="smallcat.datasets.csv_dataset.CSVSaveOptions--attributes">Attributes:<a class="headerlink" href="#smallcat.datasets.csv_dataset.CSVSaveOptions--attributes" title="Permanent link">&para;</a></h6>
<p>header
    Whether to write a header row with column names.
sep
    Field separator to use when writing (e.g. ',', '|', '\t').
overwrite
    If True, allow overwriting existing files at the destination.
    Compression is <em>inferred from the file extension</em> ('.gz', '.zst', ).</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/csv_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">class</span><span class="w"> </span><span class="nc">CSVSaveOptions</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Options that control how CSV files are *written*.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    header</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        Whether to write a header row with column names.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    sep</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        Field separator to use when writing (e.g. &#39;,&#39;, &#39;|&#39;, &#39;\t&#39;).</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    overwrite</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        If True, allow overwriting existing files at the destination.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        Compression is *inferred from the file extension* (&#39;.gz&#39;, &#39;.zst&#39;, ).</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Write a header row with column names.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Field separator to use (e.g. &#39;,&#39;, &#39;|&#39;, r&#39;</span><span class="se">\t</span><span class="s2">&#39;).&quot;</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="c1"># compression is inferred from extension (.gz, .zst, ) don&#39;t expose unless you must</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;If True, overwrite existing files at the destination.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.csv_dataset.CSVSaveOptions.header" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">header</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.header" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">header</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;Write a header row with column names.&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.csv_dataset.CSVSaveOptions.sep" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">sep</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.sep" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sep</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Field separator to use (e.g. &#39;,&#39;, &#39;|&#39;, r&#39;</span><span class="se">\t</span><span class="s2">&#39;).&quot;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.csv_dataset.CSVSaveOptions.overwrite" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">overwrite</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.csv_dataset.CSVSaveOptions.overwrite" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">overwrite</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;If True, overwrite existing files at the destination.&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div><h2 id="excel">Excel<a class="headerlink" href="#excel" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>Excel (.xlsx) dataset via DuckDB's <code>excel</code> extension.</p>
<p>This module provides :class:<code>ExcelDataset</code> for reading/writing <strong>.xlsx</strong> files
(legacy <strong>.xls</strong> is not supported). Paths are <strong>relative</strong> to the configured
base URI; the DuckDB <code>excel</code> extension is installed/loaded at runtime.</p>


<details class="capabilities" open>
  <summary>Capabilities</summary>
  <ul>
<li>Read a whole sheet or an A1 range with optional header handling.</li>
<li>Coerce empty columns or all columns to VARCHAR for schema stability.</li>
<li>Write Arrow tables to a specific sheet (with optional header row).</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ds = ExcelDataset.from_conn_id("fs_conn")
tbl = ds.load_arrow_table("inputs/budget.xlsx")  # first sheet by default
ds.save_arrow_table("outputs/budget_out.xlsx", tbl)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="options" open>
  <summary>Options</summary>
  <ul>
<li><code>ExcelLoadOptions</code>: header, sheet, range, all_varchar, empty_as_varchar.</li>
<li><code>ExcelSaveOptions</code>: header, sheet.</li>
</ul>
</details>









<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="smallcat.datasets.excel_dataset.ExcelDataset" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.excel_dataset.ExcelDataset</span>


<a href="#smallcat.datasets.excel_dataset.ExcelDataset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span>[<a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelLoadOptions">ExcelLoadOptions</a>, <a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelSaveOptions">ExcelSaveOptions</a>]</code></p>



        <p>Reads and writes <strong>.xlsx</strong> files via DuckDB's <code>excel</code> extension.</p>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Legacy <strong>.xls</strong> format is <strong>not</strong> supported.</li>
<li>Paths are treated as relative to this dataset's base URI (e.g., <code>file://</code> or
  <code>gs://</code>); use the connection extras to set the base.</li>
</ul>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/excel_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExcelDataset</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">[</span><span class="n">ExcelLoadOptions</span><span class="p">,</span> <span class="n">ExcelSaveOptions</span><span class="p">]):</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads and writes **.xlsx** files via DuckDB&#39;s `excel` extension.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">      * Legacy **.xls** format is **not** supported.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">      * Paths are treated as relative to this dataset&#39;s base URI (e.g., `file://` or</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        `gs://`); use the connection extras to set the base.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stream .xlsx rows as record batches with an optional filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>            <span class="n">con</span><span class="o">.</span><span class="n">install_extension</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="n">con</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_options_dict</span><span class="p">()</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>            <span class="n">args_sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="k">if</span> <span class="n">header</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, header = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">header</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="k">if</span> <span class="n">sheet</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sheet&quot;</span><span class="p">):</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, sheet = &#39;</span><span class="si">{</span><span class="n">sheet</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="k">if</span> <span class="n">_range</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;range&quot;</span><span class="p">):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, range = &#39;</span><span class="si">{</span><span class="n">_range</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="k">if</span> <span class="n">all_varchar</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all_varchar&quot;</span><span class="p">):</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, all_varchar = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">all_varchar</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="k">if</span> <span class="n">empty_as_varchar</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;empty_as_varchar&quot;</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, empty_as_varchar = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">empty_as_varchar</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">sql</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="sa">r</span><span class="s2">&quot;FROM\s+data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="sa">f</span><span class="s2">&quot;from read_xlsx(?</span><span class="si">{</span><span class="n">args_sql</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="k">return</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="p">[</span><span class="n">full_uri</span><span class="p">])</span><span class="o">.</span><span class="n">fetch_record_batch</span><span class="p">()</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a PyArrow table to an .xlsx file.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">          path: Relative path of the output .xlsx file (joined under the dataset base).</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">          table: The `pyarrow.Table` to write.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">          Uses DuckDB&#39;s `COPY ... TO ... WITH (FORMAT xlsx ...)` from the</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">          `excel` extension. Save-time options are translated into COPY options.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">con</span><span class="o">.</span><span class="n">install_extension</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="n">con</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">()</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="n">args_sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="k">if</span> <span class="n">header</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, HEADER </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">header</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="k">if</span> <span class="n">sheet</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sheet&quot;</span><span class="p">):</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, SHEET &#39;</span><span class="si">{</span><span class="n">sheet</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">con</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;tmp_input&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;copy (select * from tmp_input) TO ? WITH (FORMAT xlsx</span><span class="si">{</span><span class="n">args_sql</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># noqa: S608</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">[</span><span class="n">full_uri</span><span class="p">])</span><span class="o">.</span><span class="n">fetch_arrow_table</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.excel_dataset.ExcelDataset.load_arrow_record_batch_reader" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_arrow_record_batch_reader</span>


<a href="#smallcat.datasets.excel_dataset.ExcelDataset.load_arrow_record_batch_reader" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pyarrow">pa</span></span><span class="o">.</span><span class="n"><span title="pyarrow.RecordBatchReader">RecordBatchReader</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Stream .xlsx rows as record batches with an optional filter.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/excel_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream .xlsx rows as record batches with an optional filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">con</span><span class="o">.</span><span class="n">install_extension</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">con</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_options_dict</span><span class="p">()</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">args_sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">if</span> <span class="n">header</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, header = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">header</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="k">if</span> <span class="n">sheet</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sheet&quot;</span><span class="p">):</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, sheet = &#39;</span><span class="si">{</span><span class="n">sheet</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="k">if</span> <span class="n">_range</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;range&quot;</span><span class="p">):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, range = &#39;</span><span class="si">{</span><span class="n">_range</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">if</span> <span class="n">all_varchar</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;all_varchar&quot;</span><span class="p">):</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, all_varchar = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">all_varchar</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">if</span> <span class="n">empty_as_varchar</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;empty_as_varchar&quot;</span><span class="p">):</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, empty_as_varchar = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">empty_as_varchar</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">sql</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="sa">r</span><span class="s2">&quot;FROM\s+data&quot;</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="sa">f</span><span class="s2">&quot;from read_xlsx(?</span><span class="si">{</span><span class="n">args_sql</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="k">return</span> <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="p">[</span><span class="n">full_uri</span><span class="p">])</span><span class="o">.</span><span class="n">fetch_record_batch</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.excel_dataset.ExcelDataset.save_arrow_table" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_arrow_table</span>


<a href="#smallcat.datasets.excel_dataset.ExcelDataset.save_arrow_table" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_arrow_table</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n"><span title="pyarrow">pa</span></span><span class="o">.</span><span class="n"><span title="pyarrow.Table">Table</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Write a PyArrow table to an .xlsx file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative path of the output .xlsx file (joined under the dataset base).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="pyarrow">pa</span>.<span title="pyarrow.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>pyarrow.Table</code> to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Uses DuckDB's <code>COPY ... TO ... WITH (FORMAT xlsx ...)</code> from the
<code>excel</code> extension. Save-time options are translated into COPY options.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/excel_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a PyArrow table to an .xlsx file.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">      path: Relative path of the output .xlsx file (joined under the dataset base).</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">      table: The `pyarrow.Table` to write.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">      Uses DuckDB&#39;s `COPY ... TO ... WITH (FORMAT xlsx ...)` from the</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">      `excel` extension. Save-time options are translated into COPY options.</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">con</span><span class="o">.</span><span class="n">install_extension</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">con</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">lo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">()</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">args_sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">if</span> <span class="n">header</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, HEADER </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">header</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">if</span> <span class="n">sheet</span> <span class="o">:=</span> <span class="n">lo</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sheet&quot;</span><span class="p">):</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">args_sql</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, SHEET &#39;</span><span class="si">{</span><span class="n">sheet</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">con</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;tmp_input&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;copy (select * from tmp_input) TO ? WITH (FORMAT xlsx</span><span class="si">{</span><span class="n">args_sql</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># noqa: S608</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">con</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="p">[</span><span class="n">full_uri</span><span class="p">])</span><span class="o">.</span><span class="n">fetch_arrow_table</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.excel_dataset.ExcelDataset.from_conn_id" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_conn_id</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#smallcat.datasets.excel_dataset.ExcelDataset.from_conn_id" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_conn_id</span><span class="p">(</span><span class="n">conn_id</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">load_options</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.base_dataset.L">L</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save_options</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.base_dataset.S">S</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span></span><span class="p">[</span><span class="n"><span title="smallcat.datasets.base_dataset.L">L</span></span><span class="p">,</span> <span class="n"><span title="smallcat.datasets.base_dataset.S">S</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct an instance by looking up an Airflow connection ID.</p>
<p>Uses <code>airflow.hooks.base.BaseHook</code> (or the SDK alternative) to fetch
the connection and then calls the class constructor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn_id</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Airflow connection ID to resolve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_options</code>
            </td>
            <td>
                  <code><span title="smallcat.datasets.base_dataset.L">L</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional load options model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_options</code>
            </td>
            <td>
                  <code><span title="smallcat.datasets.base_dataset.S">S</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional save options model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span>[<span title="smallcat.datasets.base_dataset.L">L</span>, <span title="smallcat.datasets.base_dataset.S">S</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A fully constructed <code>BaseDataset</code> subclass instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_conn_id</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;BaseDataset[L, S]&quot;</span><span class="p">],</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">conn_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">load_options</span><span class="p">:</span> <span class="n">L</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">save_options</span><span class="p">:</span> <span class="n">S</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BaseDataset[L, S]&quot;</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct an instance by looking up an Airflow connection ID.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Uses `airflow.hooks.base.BaseHook` (or the SDK alternative) to fetch</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    the connection and then calls the class constructor.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">      conn_id: Airflow connection ID to resolve.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">      load_options: Optional load options model.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">      save_options: Optional save options model.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">      A fully constructed `BaseDataset` subclass instance.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="n">BaseHook</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Airflow not available. Install smallcat[airflow]&quot;</span><span class="p">)</span>  <span class="c1"># noqa: TRY003, EM101</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">BaseHook</span><span class="o">.</span><span class="n">get_connection</span><span class="p">(</span><span class="n">conn_id</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">conn</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span> <span class="n">load_options</span><span class="o">=</span><span class="n">load_options</span><span class="p">,</span> <span class="n">save_options</span><span class="o">=</span><span class="n">save_options</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.excel_dataset.ExcelDataset.load_pandas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_pandas</span>


<a href="#smallcat.datasets.excel_dataset.ExcelDataset.load_pandas" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_pandas</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas">pd</span></span><span class="o">.</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load data as a pandas DataFrame.</p>
<p>This is a convenience wrapper over <code>load_arrow_table</code> and pushes down
filters when provided.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative dataset path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>where</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional SQL filter predicate injected into the query.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of columns to project.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pandas <code>DataFrame</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_pandas</span><span class="p">(</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load data as a pandas DataFrame.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    This is a convenience wrapper over `load_arrow_table` and pushes down</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    filters when provided.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">      path: Relative dataset path.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">      where: Optional SQL filter predicate injected into the query.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">      columns: Optional list of columns to project.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">      A pandas `DataFrame`.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">arrow_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_arrow_table</span><span class="p">(</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">return</span> <span class="n">arrow_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.excel_dataset.ExcelDataset.save_pandas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_pandas</span>


<a href="#smallcat.datasets.excel_dataset.ExcelDataset.save_pandas" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_pandas</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n"><span title="pandas">pd</span></span><span class="o">.</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Persist a pandas DataFrame.</p>
<p>Converts the DataFrame to a <code>pyarrow.Table</code> and delegates to
<code>save_arrow_table</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative dataset path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame to persist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Persist a pandas DataFrame.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Converts the DataFrame to a `pyarrow.Table` and delegates to</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    `save_arrow_table`.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        path: Relative dataset path.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        df: DataFrame to persist.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        None</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">arrow_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">save_arrow_table</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">arrow_table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="options_1">Options<a class="headerlink" href="#options_1" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="smallcat.datasets.excel_dataset.ExcelLoadOptions" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.excel_dataset.ExcelLoadOptions</span>


<a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Options that control how an .xlsx file is read.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.header">header</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, treat the first row as column headers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.sheet">sheet</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional worksheet name to read. If omitted, the first sheet is used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.range">range</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Excel A1-style range to read (e.g., "A1:D100").
     If omitted, the full sheet is read.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.all_varchar">all_varchar</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, coerce all columns to VARCHAR (strings).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.empty_as_varchar">empty_as_varchar</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, treat empty columns as VARCHAR instead of NULL/typed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/excel_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExcelLoadOptions</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Options that control how an .xlsx file is read.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">      header: If True, treat the first row as column headers.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">      sheet: Optional worksheet name to read. If omitted, the first sheet is used.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">      range: Excel A1-style range to read (e.g., &quot;A1:D100&quot;).</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">             If omitted, the full sheet is read.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">      all_varchar: If True, coerce all columns to VARCHAR (strings).</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">      empty_as_varchar: If True, treat empty columns as VARCHAR instead of NULL/typed.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">sheet</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="nb">range</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">all_varchar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">empty_as_varchar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.excel_dataset.ExcelLoadOptions.header" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">header</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.header" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">header</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.excel_dataset.ExcelLoadOptions.sheet" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">sheet</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.sheet" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sheet</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.excel_dataset.ExcelLoadOptions.range" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">range</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.range" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">range</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.excel_dataset.ExcelLoadOptions.all_varchar" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">all_varchar</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.all_varchar" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">all_varchar</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.excel_dataset.ExcelLoadOptions.empty_as_varchar" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">empty_as_varchar</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.excel_dataset.ExcelLoadOptions.empty_as_varchar" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">empty_as_varchar</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="smallcat.datasets.excel_dataset.ExcelSaveOptions" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.excel_dataset.ExcelSaveOptions</span>


<a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Options that control how an Arrow table is written to .xlsx.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelSaveOptions.header">header</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, include column headers in the output file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.excel_dataset.ExcelSaveOptions.sheet">sheet</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional worksheet name to write into (created if missing).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/excel_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="k">class</span><span class="w"> </span><span class="nc">ExcelSaveOptions</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Options that control how an Arrow table is written to .xlsx.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">      header: If True, include column headers in the output file.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">      sheet: Optional worksheet name to write into (created if missing).</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">header</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">sheet</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.excel_dataset.ExcelSaveOptions.header" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">header</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions.header" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">header</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.excel_dataset.ExcelSaveOptions.sheet" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">sheet</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.excel_dataset.ExcelSaveOptions.sheet" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">sheet</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div><h2 id="parquet">Parquet<a class="headerlink" href="#parquet" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>Parquet dataset backed by DuckDB.</p>
<p>This module provides :class:<code>ParquetDataset</code>, a concrete implementation of
:class:<code>~smallcat.datasets.base_dataset.BaseDataset</code> that reads/writes Parquet
via DuckDB. Paths passed to public methods are <strong>relative</strong> to the configured
base (e.g., <code>file://</code> or <code>gs://</code>).</p>


<details class="features" open>
  <summary>Features</summary>
  <ul>
<li>Read from a single file, directory, or glob pattern.</li>
<li>Hive partition discovery and schema union (optional).</li>
<li>Write with optional partitioning and overwrite.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ds = ParquetDataset.from_conn_id("gcs_conn")
tbl = ds.load_arrow_table("bronze/events/*<em>/</em>.parquet")
ds.save_arrow_table("silver/events/", tbl)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="related-options" open>
  <summary>Related options</summary>
  <ul>
<li><code>ParquetLoadOptions</code>: binary_as_string, hive_partitioning, union_by_name...</li>
<li><code>ParquetSaveOptions</code>: overwrite, partition_by, write_partition_columns.</li>
</ul>
</details>









<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="smallcat.datasets.parquet_dataset.ParquetDataset" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.parquet_dataset.ParquetDataset</span>


<a href="#smallcat.datasets.parquet_dataset.ParquetDataset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span></code></p>



        <p>Parquet dataset backed by DuckDB's Parquet reader/writer.</p>
<p>Paths passed to public methods are treated as <strong>relative</strong> to the dataset's
configured base (e.g., <code>file://</code> or <code>gs://</code>). Reads return a PyArrow
table.</p>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>You can pass a single file, a directory (e.g., <code>/path/**.parquet</code>),
  or any glob DuckDB understands.</li>
</ul>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/parquet_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="k">class</span><span class="w"> </span><span class="nc">ParquetDataset</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">):</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parquet dataset backed by DuckDB&#39;s Parquet reader/writer.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    Paths passed to public methods are treated as **relative** to the dataset&#39;s</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    configured base (e.g., `file://` or `gs://`). Reads return a PyArrow</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    table.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">      * You can pass a single file, a directory (e.g., `/path/**.parquet`),</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        or any glob DuckDB understands.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stream Parquet rows as record batches with an optional filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="n">rel</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">full_uri</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">load_options_dict</span><span class="p">())</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="k">return</span> <span class="n">rel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_record_batch</span><span class="p">()</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a PyArrow table to Parquet.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">          path: Relative output path (file or directory) joined under the</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">            dataset base URI.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">          table: The `pyarrow.Table` to write.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">          Uses `Relation.write_parquet` with parameters from</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">          `save_options_dict()`.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">con</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;tmp_input&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM tmp_input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_parquet</span><span class="p">(</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                <span class="n">full_uri</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.parquet_dataset.ParquetDataset.load_arrow_record_batch_reader" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_arrow_record_batch_reader</span>


<a href="#smallcat.datasets.parquet_dataset.ParquetDataset.load_arrow_record_batch_reader" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pyarrow">pa</span></span><span class="o">.</span><span class="n"><span title="pyarrow.RecordBatchReader">RecordBatchReader</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Stream Parquet rows as record batches with an optional filter.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/parquet_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream Parquet rows as record batches with an optional filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">rel</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">full_uri</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">load_options_dict</span><span class="p">())</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="k">return</span> <span class="n">rel</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_record_batch</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.parquet_dataset.ParquetDataset.save_arrow_table" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_arrow_table</span>


<a href="#smallcat.datasets.parquet_dataset.ParquetDataset.save_arrow_table" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_arrow_table</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n"><span title="pyarrow">pa</span></span><span class="o">.</span><span class="n"><span title="pyarrow.Table">Table</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Write a PyArrow table to Parquet.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative output path (file or directory) joined under the
dataset base URI.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="pyarrow">pa</span>.<span title="pyarrow.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>pyarrow.Table</code> to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Uses <code>Relation.write_parquet</code> with parameters from
<code>save_options_dict()</code>.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/parquet_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a PyArrow table to Parquet.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">      path: Relative output path (file or directory) joined under the</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        dataset base URI.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">      table: The `pyarrow.Table` to write.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">      Uses `Relation.write_parquet` with parameters from</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">      `save_options_dict()`.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">con</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;tmp_input&quot;</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM tmp_input&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_parquet</span><span class="p">(</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="n">full_uri</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.parquet_dataset.ParquetDataset.from_conn_id" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_conn_id</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#smallcat.datasets.parquet_dataset.ParquetDataset.from_conn_id" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_conn_id</span><span class="p">(</span><span class="n">conn_id</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">load_options</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.base_dataset.L">L</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save_options</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.base_dataset.S">S</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span></span><span class="p">[</span><span class="n"><span title="smallcat.datasets.base_dataset.L">L</span></span><span class="p">,</span> <span class="n"><span title="smallcat.datasets.base_dataset.S">S</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct an instance by looking up an Airflow connection ID.</p>
<p>Uses <code>airflow.hooks.base.BaseHook</code> (or the SDK alternative) to fetch
the connection and then calls the class constructor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn_id</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Airflow connection ID to resolve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_options</code>
            </td>
            <td>
                  <code><span title="smallcat.datasets.base_dataset.L">L</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional load options model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_options</code>
            </td>
            <td>
                  <code><span title="smallcat.datasets.base_dataset.S">S</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional save options model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span>[<span title="smallcat.datasets.base_dataset.L">L</span>, <span title="smallcat.datasets.base_dataset.S">S</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A fully constructed <code>BaseDataset</code> subclass instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_conn_id</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;BaseDataset[L, S]&quot;</span><span class="p">],</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">conn_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">load_options</span><span class="p">:</span> <span class="n">L</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">save_options</span><span class="p">:</span> <span class="n">S</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BaseDataset[L, S]&quot;</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct an instance by looking up an Airflow connection ID.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Uses `airflow.hooks.base.BaseHook` (or the SDK alternative) to fetch</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    the connection and then calls the class constructor.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">      conn_id: Airflow connection ID to resolve.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">      load_options: Optional load options model.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">      save_options: Optional save options model.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">      A fully constructed `BaseDataset` subclass instance.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="n">BaseHook</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Airflow not available. Install smallcat[airflow]&quot;</span><span class="p">)</span>  <span class="c1"># noqa: TRY003, EM101</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">BaseHook</span><span class="o">.</span><span class="n">get_connection</span><span class="p">(</span><span class="n">conn_id</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">conn</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span> <span class="n">load_options</span><span class="o">=</span><span class="n">load_options</span><span class="p">,</span> <span class="n">save_options</span><span class="o">=</span><span class="n">save_options</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.parquet_dataset.ParquetDataset.load_pandas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_pandas</span>


<a href="#smallcat.datasets.parquet_dataset.ParquetDataset.load_pandas" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_pandas</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas">pd</span></span><span class="o">.</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load data as a pandas DataFrame.</p>
<p>This is a convenience wrapper over <code>load_arrow_table</code> and pushes down
filters when provided.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative dataset path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>where</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional SQL filter predicate injected into the query.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of columns to project.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pandas <code>DataFrame</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_pandas</span><span class="p">(</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load data as a pandas DataFrame.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    This is a convenience wrapper over `load_arrow_table` and pushes down</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    filters when provided.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">      path: Relative dataset path.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">      where: Optional SQL filter predicate injected into the query.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">      columns: Optional list of columns to project.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">      A pandas `DataFrame`.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">arrow_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_arrow_table</span><span class="p">(</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">return</span> <span class="n">arrow_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.parquet_dataset.ParquetDataset.save_pandas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_pandas</span>


<a href="#smallcat.datasets.parquet_dataset.ParquetDataset.save_pandas" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_pandas</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n"><span title="pandas">pd</span></span><span class="o">.</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Persist a pandas DataFrame.</p>
<p>Converts the DataFrame to a <code>pyarrow.Table</code> and delegates to
<code>save_arrow_table</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative dataset path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame to persist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Persist a pandas DataFrame.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Converts the DataFrame to a `pyarrow.Table` and delegates to</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    `save_arrow_table`.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        path: Relative dataset path.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        df: DataFrame to persist.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        None</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">arrow_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">save_arrow_table</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">arrow_table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="options_2">Options<a class="headerlink" href="#options_2" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="smallcat.datasets.parquet_dataset.ParquetLoadOptions" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.parquet_dataset.ParquetLoadOptions</span>


<a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Options that control how Parquet is read via DuckDB.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.binary_as_string">binary_as_string</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, interpret BINARY columns as strings.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.file_row_number">file_row_number</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, include a synthetic row-number column per file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.hive_partitioning">hive_partitioning</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, parse Hive-style directory partitions.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.union_by_name">union_by_name</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, align/union schemas by column name across files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/parquet_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="k">class</span><span class="w"> </span><span class="nc">ParquetLoadOptions</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Options that control how Parquet is read via DuckDB.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">      binary_as_string: If True, interpret BINARY columns as strings.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">      file_row_number: If True, include a synthetic row-number column per file.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">      hive_partitioning: If True, parse Hive-style directory partitions.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">      union_by_name: If True, align/union schemas by column name across files.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">binary_as_string</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">file_row_number</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">hive_partitioning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">union_by_name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.parquet_dataset.ParquetLoadOptions.binary_as_string" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">binary_as_string</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.binary_as_string" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">binary_as_string</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.parquet_dataset.ParquetLoadOptions.file_row_number" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">file_row_number</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.file_row_number" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">file_row_number</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.parquet_dataset.ParquetLoadOptions.hive_partitioning" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">hive_partitioning</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.hive_partitioning" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">hive_partitioning</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.parquet_dataset.ParquetLoadOptions.union_by_name" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">union_by_name</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.parquet_dataset.ParquetLoadOptions.union_by_name" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">union_by_name</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="smallcat.datasets.parquet_dataset.ParquetSaveOptions" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.parquet_dataset.ParquetSaveOptions</span>


<a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Options that control how Parquet is written via DuckDB.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.overwrite">overwrite</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite existing output.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.partition_by">partition_by</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns to partition by (Hive-style layout).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.write_partition_columns">write_partition_columns</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, also materialize partition cols in files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/parquet_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="k">class</span><span class="w"> </span><span class="nc">ParquetSaveOptions</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Options that control how Parquet is written via DuckDB.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">      overwrite: If True, overwrite existing output.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">      partition_by: Columns to partition by (Hive-style layout).</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">      write_partition_columns: If True, also materialize partition cols in files.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">partition_by</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">write_partition_columns</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.parquet_dataset.ParquetSaveOptions.overwrite" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">overwrite</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.overwrite" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">overwrite</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.parquet_dataset.ParquetSaveOptions.partition_by" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">partition_by</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.partition_by" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">partition_by</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.parquet_dataset.ParquetSaveOptions.write_partition_columns" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">write_partition_columns</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.parquet_dataset.ParquetSaveOptions.write_partition_columns" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">write_partition_columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div><h2 id="delta-table">Delta Table<a class="headerlink" href="#delta-table" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

        <p>Delta Lake dataset using delta-rs (deltalake) with Smallcat.</p>
<p>This module implements :class:<code>DeltaTableDataset</code>, a Delta Lake reader/writer
powered by <code>deltalake</code> (delta-rs). It resolves relative paths against the
connection base (e.g., <code>gs://bucket/prefix</code>) and returns/accepts Arrow tables.</p>


<details class="storage-backends" open>
  <summary>Storage backends</summary>
  <ul>
<li>Local filesystem (<code>fs</code>) - no extra options.</li>
<li>Google Cloud Storage (<code>google_cloud_platform</code>) - credentials derived from
  connection extras: <code>keyfile_dict</code> / <code>keyfile</code> / <code>key_path</code>.</li>
<li>Databricks - minimal env vars exported (workspace URL and token).</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ds = DeltaTableDataset.from_conn_id("gcs_delta")
tbl = ds.load_arrow_table("bronze/events_delta")
ds.save_arrow_table("silver/events_delta", tbl)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="options" open>
  <summary>Options</summary>
  <ul>
<li><code>DeltaTableLoadOptions</code>: version, without_files, log_buffer_size.</li>
<li><code>DeltaTableSaveOptions</code>: mode, partition_by, schema_mode.</li>
</ul>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <p>For Databricks, this module sets:
<code>DATABRICKS_WORKSPACE_URL</code> and <code>DATABRICKS_ACCESS_TOKEN</code> before access.</p>
</details>









<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="smallcat.datasets.delta_table_dataset.DeltaTableDataset" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.delta_table_dataset.DeltaTableDataset</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span>[<a class="autorefs autorefs-internal" href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions">DeltaTableLoadOptions</a>, <a class="autorefs autorefs-internal" href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions">DeltaTableSaveOptions</a>]</code></p>



        <p>Delta Lake dataset that reads/writes via delta-rs (DeltaTable / write_deltalake).</p>
<p>Paths passed to public methods are treated as <strong>relative</strong> to the dataset's
configured base (e.g., local <code>file://</code> or <code>gs://</code>). Reads return a
PyArrow table.</p>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>For Google Cloud Storage, credentials are derived from the connection's
  extras (e.g., <code>keyfile_dict</code>, <code>keyfile</code>, or <code>key_path</code>).</li>
<li>For <code>conn_type == "databricks"</code>, environment variables are set to
  support Databricks-hosted Delta.</li>
</ul>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/delta_table_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="k">class</span><span class="w"> </span><span class="nc">DeltaTableDataset</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">[</span><span class="n">DeltaTableLoadOptions</span><span class="p">,</span> <span class="n">DeltaTableSaveOptions</span><span class="p">]):</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Delta Lake dataset that reads/writes via delta-rs (DeltaTable / write_deltalake).</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Paths passed to public methods are treated as **relative** to the dataset&#39;s</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    configured base (e.g., local `file://` or `gs://`). Reads return a</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    PyArrow table.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">      * For Google Cloud Storage, credentials are derived from the connection&#39;s</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        extras (e.g., `keyfile_dict`, `keyfile`, or `key_path`).</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">      * For `conn_type == &quot;databricks&quot;`, environment variables are set to</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        support Databricks-hosted Delta.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_delta_storage_options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build `storage_options` for delta-rs reads/writes.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        The options are derived from the active connection:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">          * `fs` (local): returns `{}`.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">          * `google_cloud_platform`: uses one of:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">              - `extras.keyfile_dict` (dict or JSON string)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">              - `extras.keyfile` (raw JSON string)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">              - `extras.key_path` (path on worker)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">          A mapping suitable for the `storage_options` parameter used by</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">          `deltalake.DeltaTable` and `deltalake.write_deltalake`. For GCS,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">          keys include one of:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            * `google_service_account_key` (serialized JSON)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            * `google_service_account` (path to keyfile)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">          ValueError: If the connection type is not supported.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fs&quot;</span><span class="p">,</span> <span class="s2">&quot;google_cloud_platform&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Storage options not implemented for type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_type</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>                <span class="n">msg</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extras</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="c1"># keyfile_dict can be dict or JSON string</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">kfd</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;keyfile_dict&quot;</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kfd</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                <span class="n">kfd</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">kfd</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                <span class="c1"># If it&#39;s not JSON, ignore and fall through</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="n">kfd</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kfd</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kfd</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="c1"># Provide serialized key via &#39;google_service_account_key&#39;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;google_service_account_key&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">kfd</span><span class="p">)}</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;keyfile&quot;</span><span class="p">):</span>  <span class="c1"># raw JSON string</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;google_service_account_key&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;keyfile&quot;</span><span class="p">]}</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key_path&quot;</span><span class="p">):</span>  <span class="c1"># path on worker</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;google_service_account&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;key_path&quot;</span><span class="p">]}</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_set_databricks_acces_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export minimal environment variables for Databricks-hosted Delta.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Sets:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">          * `DATABRICKS_WORKSPACE_URL` from `self.conn.host`</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">          * `DATABRICKS_ACCESS_TOKEN` from `self.conn.password`</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">          These variables are used by delta-rs when accessing Databricks.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Databricks connection requires both host and password.&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;DATABRICKS_WORKSPACE_URL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;DATABRICKS_ACCESS_TOKEN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">password</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stream Delta Lake rows via DuckDB with an optional filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_type</span> <span class="o">==</span> <span class="s2">&quot;databricks&quot;</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_databricks_acces_variables</span><span class="p">()</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">storage_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_storage_options</span><span class="p">()</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">dt</span> <span class="o">=</span> <span class="n">DeltaTable</span><span class="p">(</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="n">full_uri</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">load_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">dataset</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">to_pyarrow_dataset</span><span class="p">()</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">con</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="k">return</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_record_batch</span><span class="p">()</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Write a PyArrow table to Delta Lake using delta-rs.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">          path: Relative path to the target Delta table (joined under the</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            dataset&#39;s base URI).</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">          table: The `pyarrow.Table` to write.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">          * If `conn_type == &quot;databricks&quot;`, this method sets Databricks</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            environment variables via `_set_databricks_acces_variables`.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            (The write is otherwise handled by delta-rs for non-Databricks.)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;True Delta write using delta-rs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">table_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_type</span> <span class="o">==</span> <span class="s2">&quot;databricks&quot;</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_set_databricks_acces_variables</span><span class="p">()</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">storage_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_storage_options</span><span class="p">()</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">engine</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                    <span class="s2">&quot;rust&quot;</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_options</span><span class="o">.</span><span class="n">schema_mode</span> <span class="o">==</span> <span class="n">SchemaMode</span><span class="o">.</span><span class="n">MERGE</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                    <span class="k">else</span> <span class="s2">&quot;pyarrow&quot;</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                <span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="n">write_deltalake</span><span class="p">(</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                    <span class="n">table_or_uri</span><span class="o">=</span><span class="n">table_uri</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                    <span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                    <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                    <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                    <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                <span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span class="c1"># Newer versions use the rust engine and don&#39;t take the engine parameter</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="n">write_deltalake</span><span class="p">(</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                    <span class="n">table_or_uri</span><span class="o">=</span><span class="n">table_uri</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                    <span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                    <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                    <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableDataset._delta_storage_options" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_delta_storage_options</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset._delta_storage_options" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">_delta_storage_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/reference/expressions.html#dict">dict</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Build <code>storage_options</code> for delta-rs reads/writes.</p>


<details class="the-options-are-derived-from-the-active-connection" open>
  <summary>The options are derived from the active connection</summary>
  <ul>
<li><code>fs</code> (local): returns <code>{}</code>.</li>
<li><code>google_cloud_platform</code>: uses one of:<ul>
<li><code>extras.keyfile_dict</code> (dict or JSON string)</li>
<li><code>extras.keyfile</code> (raw JSON string)</li>
<li><code>extras.key_path</code> (path on worker)</li>
</ul>
</li>
</ul>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/reference/expressions.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A mapping suitable for the <code>storage_options</code> parameter used by</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/reference/expressions.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>deltalake.DeltaTable</code> and <code>deltalake.write_deltalake</code>. For GCS,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/reference/expressions.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>keys include one of:
* <code>google_service_account_key</code> (serialized JSON)
* <code>google_service_account</code> (path to keyfile)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the connection type is not supported.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/delta_table_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="k">def</span><span class="w"> </span><span class="nf">_delta_storage_options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Build `storage_options` for delta-rs reads/writes.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    The options are derived from the active connection:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">      * `fs` (local): returns `{}`.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">      * `google_cloud_platform`: uses one of:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">          - `extras.keyfile_dict` (dict or JSON string)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">          - `extras.keyfile` (raw JSON string)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">          - `extras.key_path` (path on worker)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">      A mapping suitable for the `storage_options` parameter used by</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">      `deltalake.DeltaTable` and `deltalake.write_deltalake`. For GCS,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">      keys include one of:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        * `google_service_account_key` (serialized JSON)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        * `google_service_account` (path to keyfile)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">      ValueError: If the connection type is not supported.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;fs&quot;</span><span class="p">,</span> <span class="s2">&quot;google_cloud_platform&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Storage options not implemented for type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_type</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">msg</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extras</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="c1"># keyfile_dict can be dict or JSON string</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">kfd</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;keyfile_dict&quot;</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kfd</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="n">kfd</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">kfd</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="c1"># If it&#39;s not JSON, ignore and fall through</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="n">kfd</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kfd</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">kfd</span><span class="p">:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="c1"># Provide serialized key via &#39;google_service_account_key&#39;</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;google_service_account_key&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">kfd</span><span class="p">)}</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;keyfile&quot;</span><span class="p">):</span>  <span class="c1"># raw JSON string</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;google_service_account_key&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;keyfile&quot;</span><span class="p">]}</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key_path&quot;</span><span class="p">):</span>  <span class="c1"># path on worker</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;google_service_account&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;key_path&quot;</span><span class="p">]}</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableDataset._set_databricks_acces_variables" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_set_databricks_acces_variables</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset._set_databricks_acces_variables" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">_set_databricks_acces_variables</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Export minimal environment variables for Databricks-hosted Delta.</p>


<details class="sets" open>
  <summary>Sets</summary>
  <ul>
<li><code>DATABRICKS_WORKSPACE_URL</code> from <code>self.conn.host</code></li>
<li><code>DATABRICKS_ACCESS_TOKEN</code> from <code>self.conn.password</code></li>
</ul>
</details>

<details class="notes" open>
  <summary>Notes</summary>
  <p>These variables are used by delta-rs when accessing Databricks.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/delta_table_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="k">def</span><span class="w"> </span><span class="nf">_set_databricks_acces_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Export minimal environment variables for Databricks-hosted Delta.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Sets:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">      * `DATABRICKS_WORKSPACE_URL` from `self.conn.host`</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">      * `DATABRICKS_ACCESS_TOKEN` from `self.conn.password`</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">      These variables are used by delta-rs when accessing Databricks.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Databricks connection requires both host and password.&quot;</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;DATABRICKS_WORKSPACE_URL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">host</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;DATABRICKS_ACCESS_TOKEN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">password</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableDataset.load_arrow_record_batch_reader" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_arrow_record_batch_reader</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.load_arrow_record_batch_reader" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pyarrow">pa</span></span><span class="o">.</span><span class="n"><span title="pyarrow.RecordBatchReader">RecordBatchReader</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Stream Delta Lake rows via DuckDB with an optional filter.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/delta_table_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_arrow_record_batch_reader</span><span class="p">(</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pa</span><span class="o">.</span><span class="n">RecordBatchReader</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream Delta Lake rows via DuckDB with an optional filter.&quot;&quot;&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">full_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_type</span> <span class="o">==</span> <span class="s2">&quot;databricks&quot;</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_databricks_acces_variables</span><span class="p">()</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_query</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">storage_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_storage_options</span><span class="p">()</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">dt</span> <span class="o">=</span> <span class="n">DeltaTable</span><span class="p">(</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">full_uri</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">load_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="n">dataset</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">to_pyarrow_dataset</span><span class="p">()</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duckdb_conn</span><span class="p">()</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">con</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="k">return</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_record_batch</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableDataset.save_arrow_table" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_arrow_table</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.save_arrow_table" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_arrow_table</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n"><span title="pyarrow">pa</span></span><span class="o">.</span><span class="n"><span title="pyarrow.Table">Table</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Write a PyArrow table to Delta Lake using delta-rs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative path to the target Delta table (joined under the
dataset's base URI).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="pyarrow">pa</span>.<span title="pyarrow.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>pyarrow.Table</code> to write.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If <code>conn_type == "databricks"</code>, this method sets Databricks
  environment variables via <code>_set_databricks_acces_variables</code>.
  (The write is otherwise handled by delta-rs for non-Databricks.)</li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/delta_table_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_arrow_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Write a PyArrow table to Delta Lake using delta-rs.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">      path: Relative path to the target Delta table (joined under the</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        dataset&#39;s base URI).</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">      table: The `pyarrow.Table` to write.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">      * If `conn_type == &quot;databricks&quot;`, this method sets Databricks</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        environment variables via `_set_databricks_acces_variables`.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        (The write is otherwise handled by delta-rs for non-Databricks.)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;True Delta write using delta-rs.&quot;&quot;&quot;</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">table_uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_uri</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">conn</span><span class="o">.</span><span class="n">conn_type</span> <span class="o">==</span> <span class="s2">&quot;databricks&quot;</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_databricks_acces_variables</span><span class="p">()</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">storage_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta_storage_options</span><span class="p">()</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="n">engine</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="s2">&quot;rust&quot;</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_options</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_options</span><span class="o">.</span><span class="n">schema_mode</span> <span class="o">==</span> <span class="n">SchemaMode</span><span class="o">.</span><span class="n">MERGE</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                <span class="k">else</span> <span class="s2">&quot;pyarrow&quot;</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="n">write_deltalake</span><span class="p">(</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="n">table_or_uri</span><span class="o">=</span><span class="n">table_uri</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="c1"># Newer versions use the rust engine and don&#39;t take the engine parameter</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="n">write_deltalake</span><span class="p">(</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="n">table_or_uri</span><span class="o">=</span><span class="n">table_uri</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span class="n">data</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">save_options_dict</span><span class="p">(),</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableDataset.from_conn_id" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_conn_id</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.from_conn_id" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">from_conn_id</span><span class="p">(</span><span class="n">conn_id</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">load_options</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.base_dataset.L">L</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">save_options</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.base_dataset.S">S</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span></span><span class="p">[</span><span class="n"><span title="smallcat.datasets.base_dataset.L">L</span></span><span class="p">,</span> <span class="n"><span title="smallcat.datasets.base_dataset.S">S</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct an instance by looking up an Airflow connection ID.</p>
<p>Uses <code>airflow.hooks.base.BaseHook</code> (or the SDK alternative) to fetch
the connection and then calls the class constructor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>conn_id</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Airflow connection ID to resolve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_options</code>
            </td>
            <td>
                  <code><span title="smallcat.datasets.base_dataset.L">L</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional load options model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_options</code>
            </td>
            <td>
                  <code><span title="smallcat.datasets.base_dataset.S">S</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional save options model.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="smallcat.datasets.base_dataset.BaseDataset">BaseDataset</span>[<span title="smallcat.datasets.base_dataset.L">L</span>, <span title="smallcat.datasets.base_dataset.S">S</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A fully constructed <code>BaseDataset</code> subclass instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="nd">@classmethod</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_conn_id</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="s2">&quot;BaseDataset[L, S]&quot;</span><span class="p">],</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">conn_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">load_options</span><span class="p">:</span> <span class="n">L</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">save_options</span><span class="p">:</span> <span class="n">S</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BaseDataset[L, S]&quot;</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct an instance by looking up an Airflow connection ID.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Uses `airflow.hooks.base.BaseHook` (or the SDK alternative) to fetch</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    the connection and then calls the class constructor.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">      conn_id: Airflow connection ID to resolve.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">      load_options: Optional load options model.</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">      save_options: Optional save options model.</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">      A fully constructed `BaseDataset` subclass instance.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="n">BaseHook</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Airflow not available. Install smallcat[airflow]&quot;</span><span class="p">)</span>  <span class="c1"># noqa: TRY003, EM101</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">conn</span> <span class="o">=</span> <span class="n">BaseHook</span><span class="o">.</span><span class="n">get_connection</span><span class="p">(</span><span class="n">conn_id</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">conn</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span> <span class="n">load_options</span><span class="o">=</span><span class="n">load_options</span><span class="p">,</span> <span class="n">save_options</span><span class="o">=</span><span class="n">save_options</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableDataset.load_pandas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">load_pandas</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.load_pandas" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_pandas</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pandas">pd</span></span><span class="o">.</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load data as a pandas DataFrame.</p>
<p>This is a convenience wrapper over <code>load_arrow_table</code> and pushes down
filters when provided.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative dataset path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>where</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional SQL filter predicate injected into the query.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of columns to project.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pandas <code>DataFrame</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_pandas</span><span class="p">(</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">where</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load data as a pandas DataFrame.</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    This is a convenience wrapper over `load_arrow_table` and pushes down</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    filters when provided.</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">      path: Relative dataset path.</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">      where: Optional SQL filter predicate injected into the query.</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">      columns: Optional list of columns to project.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">      A pandas `DataFrame`.</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">arrow_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_arrow_table</span><span class="p">(</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">return</span> <span class="n">arrow_table</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableDataset.save_pandas" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">save_pandas</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableDataset.save_pandas" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">save_pandas</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n"><span title="pandas">pd</span></span><span class="o">.</span><span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Persist a pandas DataFrame.</p>
<p>Converts the DataFrame to a <code>pyarrow.Table</code> and delegates to
<code>save_arrow_table</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Relative dataset path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame to persist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/smallcat/datasets/base_dataset.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Persist a pandas DataFrame.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Converts the DataFrame to a `pyarrow.Table` and delegates to</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    `save_arrow_table`.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        path: Relative dataset path.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        df: DataFrame to persist.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        None</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">arrow_table</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">save_arrow_table</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">arrow_table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="options_3">Options<a class="headerlink" href="#options_3" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Options controlling how a Delta table is read.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.version">version</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional table version to read.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.without_files">without_files</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip listing data files (metadata-only read).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.log_buffer_size">log_buffer_size</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Buffer size for reading Delta logs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/delta_table_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="k">class</span><span class="w"> </span><span class="nc">DeltaTableLoadOptions</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Options controlling how a Delta table is read.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">      version: Optional table version to read.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">      without_files: If True, skip listing data files (metadata-only read).</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">      log_buffer_size: Buffer size for reading Delta logs.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">version</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">without_files</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">log_buffer_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.version" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">version</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.version" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">version</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.without_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">without_files</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.without_files" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">without_files</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.log_buffer_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">log_buffer_size</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.delta_table_dataset.DeltaTableLoadOptions.log_buffer_size" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">log_buffer_size</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions</span>


<a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Options controlling how a Delta table is written.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.mode">mode</a></code></td>
            <td>
                  <code><span title="smallcat.datasets.delta_table_dataset.WriteMode">WriteMode</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Write mode to apply if the table exists.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.partition_by">partition_by</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Columns to partition by (Hive-style directory layout).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.schema_mode">schema_mode</a></code></td>
            <td>
                  <code><span title="smallcat.datasets.delta_table_dataset.SchemaMode">SchemaMode</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Strategy to reconcile schema differences during write.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/smallcat/datasets/delta_table_dataset.py</code></summary>
                <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="k">class</span><span class="w"> </span><span class="nc">DeltaTableSaveOptions</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Options controlling how a Delta table is written.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">      mode: Write mode to apply if the table exists.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">      partition_by: Columns to partition by (Hive-style directory layout).</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">      schema_mode: Strategy to reconcile schema differences during write.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">mode</span><span class="p">:</span> <span class="n">WriteMode</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Write mode for existing tables.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">partition_by</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Columns to partition by (Hive-style directory layout).&quot;</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">schema_mode</span><span class="p">:</span> <span class="n">SchemaMode</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;How to handle schema differences on write.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.mode" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">mode</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.mode" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">mode</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.delta_table_dataset.WriteMode">WriteMode</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;Write mode for existing tables.&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.partition_by" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">partition_by</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.partition_by" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">partition_by</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/glossary.html#term-list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;Columns to partition by (Hive-style directory layout).&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.schema_mode" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">schema_mode</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#smallcat.datasets.delta_table_dataset.DeltaTableSaveOptions.schema_mode" class="headerlink" title="Permanent link">&para;</a></h5>
<div class="language-python doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">schema_mode</span><span class="p">:</span> <span class="n"><span title="smallcat.datasets.delta_table_dataset.SchemaMode">SchemaMode</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;How to handle schema differences on write.&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023-2025 Deep Kernel Labs S.L.
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/DeepKernelLabs" target="_blank" rel="noopener" title="DKL on Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.linkedin.com/company/deep-kernel-labs" target="_blank" rel="noopener" title="DKL on Linkedin" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>